<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>Oneshot Report – {{ host }}</title>
<style>
  body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; margin: 24px; }
  .pill { display:inline-block; padding:2px 10px; border-radius:999px; background:#eef; margin:2px; }
  .card { border:1px solid #ddd; border-radius:12px; padding:16px; margin:16px 0; }
  .grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(260px,1fr)); gap:12px; }
  summary { cursor:pointer; }
  code, pre { background:#f7f7f7; border-radius:6px; padding:8px; display:block; overflow:auto; }
  img { max-width:100%; border:1px solid #ddd; border-radius:12px; }
  table { border-collapse: collapse; width:100%; }
  th, td { border-bottom:1px solid #eee; text-align:left; padding:6px 8px; }
</style>
</head>
<body>
<h1>Oneshot Report</h1>
<div class="card">
  <div><b>Target / Host:</b> {{ host }}</div>
  <div><b>Open Ports:</b> {% for p in ports %}<span class="pill">{{ p }}</span>{% else %}<i>none</i>{% endfor %}</div>
</div>

<div class="card">
  <h2>Summary</h2>
  <details open><summary>out.json</summary>
    <pre>{{ data | tojson(indent=2) }}</pre>
  </details>
</div>

<div class="card">
  <h2>Web Screenshots</h2>
  {% if screens %}
  <div class="grid">
    {% for s in screens %}
      <div><div><b>{{ s.name }}</b></div><img src="{{ s.data_uri }}" alt="{{ s.name }}"/></div>
    {% endfor %}
  </div>
  {% else %}
    <i>No screenshots</i>
  {% endif %}
</div>

<div class="card">
  <h2>Artifacts (selected)</h2>
  {% if artifacts %}
    {% for a in artifacts %}
      <details>
        <summary>{{ a.path }} <small>({{ a.size }} bytes)</small></summary>
        {% if a.content %}<pre>{{ a.content }}</pre>{% else %}<i>binary/large – see {{ a.path }} on disk</i>{% endif %}
      </details>
    {% endfor %}
  {% else %}
    <i>No artifacts</i>
  {% endif %}
</div>

<div class="card">
  <h2>eBPF (first 200 events)</h2>
  {% if bpf_events %}
    <table>
      <thead><tr><th>ts</th><th>comm</th><th>pid</th><th>src</th><th>dst</th><th>state</th></tr></thead>
      <tbody>
      {% for e in bpf_events %}
        <tr>
          <td>{{ e.ts }}</td>
          <td>{{ e.comm }}</td>
          <td>{{ e.pid }}</td>
          <td>{{ e.src_ip }}:{{ e.src_port }}</td>
          <td>{{ e.dst_ip }}:{{ e.dst_port }}</td>
          <td>{{ e.state }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  {% else %}
    <i>No BPF events file found</i>
  {% endif %}
</div>

<footer><small>Generated by oneshot-reporter</small></footer>
</body>
</html>

